# ─── ZSH SECURITY LOGOUT ─────────────────────────────────────────────────────

# Optimized logout with essential security cleanup
# This file provides intelligent terminal cleanup for security

# ─── SECURITY CLEANUP ───────────────────────────────────────────────────────

# Clean up sensitive variables and connections
_security_cleanup() {
    # Clear sensitive environment variables
    unset SSH_AUTH_SOCK SSH_AGENT_PID SSH_CLIENT SSH_CONNECTION
    unset GPG_AGENT_INFO GNUPGHOME
    unset DOCKER_HOST DOCKER_TLS_VERIFY DOCKER_CERT_PATH
    
    # Clear temporary variables
    unset TMPDIR TEMP TMP
    
    # Kill background processes if any
    local bg_jobs=$(jobs -p 2>/dev/null)
    if [[ -n "$bg_jobs" ]]; then
        kill $bg_jobs 2>/dev/null || true
    fi
    
    # Close any open file descriptors
    exec 3>&- 4>&- 5>&- 6>&- 7>&- 8>&- 9>&- 2>/dev/null || true
}

# ─── EXECUTION ──────────────────────────────────────────────────────────────

# Run security cleanup on logout
_security_cleanup
